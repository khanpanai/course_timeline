{"version":3,"file":"step.min.js","sources":["../src/step.js"],"sourcesContent":["import * as config from 'core/config';\nexport const init = async() => {\n\n    const courseSelect = document.querySelector(\"[name='ramctl-course-select']\");\n\n    await loadSections(courseSelect.value);\n    await initSections(courseSelect.value);\n    courseSelect.addEventListener('change', async function() {\n        await loadSections(courseSelect.value);\n        await initSections(courseSelect.value);\n    });\n\n};\n\nconst initSections = async (courseId) => {\n    const sectionSelect = document.querySelector(\"[name='ramctl-section-select']\");\n    await loadTimeline(courseId, sectionSelect.value);\n    await loadEndTime(courseId, sectionSelect.value);\n    sectionSelect.addEventListener('change', async function() {\n        await loadTimeline(courseId, this.value);\n        await loadEndTime(courseId, sectionSelect.value);\n    });\n};\n\nconst loadSections = async(id) => {\n    const startNode = window.document.querySelector(\"[data-section-select]\");\n    const requestUrl = new URL(`${config.wwwroot}/blocks/course_timeline/ajax.php?action=get_modules&courseId=${+id}`);\n    const response = await fetch(requestUrl);\n    const responseHtml = await response.text();\n    window.console.log(responseHtml);\n    startNode.textContent = \"\";\n    startNode.insertAdjacentHTML(\"afterbegin\", responseHtml);\n};\n\nconst loadTimeline = async(courseId, id) => {\n    const startNode = window.document.getElementById(\"ramctl-content\");\n\n    const requestUrl =\n        new URL(`${config.wwwroot}/blocks/course_timeline/ajax.php?action=timeline&sectionId=${+id}&courseId=${+courseId}`);\n    const response = await fetch(requestUrl);\n    const responseHtml = await response.text();\n\n    startNode.textContent = \"\";\n    startNode.insertAdjacentHTML(\"afterbegin\", responseHtml);\n\n};\n\nconst loadEndTime = async(courseId, id) => {\n    const startNode = window.document.querySelector(\"span[data-end]\");\n\n    const requestUrl =\n        new URL(`${config.wwwroot}/blocks/course_timeline/ajax.php?action=end&sectionId=${+id}&courseId=${+courseId}`);\n    const response = await fetch(requestUrl);\n    const responseHtml = await response.text();\n\n    startNode.innerHTML = responseHtml;\n};"],"names":["async","courseSelect","document","querySelector","loadSections","value","initSections","addEventListener","sectionSelect","loadTimeline","courseId","loadEndTime","this","startNode","window","requestUrl","URL","config","wwwroot","id","response","fetch","responseHtml","text","console","log","textContent","insertAdjacentHTML","getElementById","innerHTML"],"mappings":"mmCACoBA,gBAEVC,aAAeC,SAASC,cAAc,uCAEtCC,aAAaH,aAAaI,aAC1BC,aAAaL,aAAaI,OAChCJ,aAAaM,iBAAiB,UAAUP,uBAC9BI,aAAaH,aAAaI,aAC1BC,aAAaL,aAAaI,iBAKlCC,aAAeN,MAAAA,iBACXQ,cAAgBN,SAASC,cAAc,wCACvCM,aAAaC,SAAUF,cAAcH,aACrCM,YAAYD,SAAUF,cAAcH,OAC1CG,cAAcD,iBAAiB,UAAUP,uBAC/BS,aAAaC,SAAUE,KAAKP,aAC5BM,YAAYD,SAAUF,cAAcH,WAI5CD,aAAeJ,MAAAA,WACXa,UAAYC,OAAOZ,SAASC,cAAc,yBAC1CY,WAAa,IAAIC,IAAK,GAAEC,OAAOC,wEAAwEC,MACvGC,eAAiBC,MAAMN,YACvBO,mBAAqBF,SAASG,OACpCT,OAAOU,QAAQC,IAAIH,cACnBT,UAAUa,YAAc,GACxBb,UAAUc,mBAAmB,aAAcL,eAGzCb,aAAeT,MAAMU,SAAUS,YAC3BN,UAAYC,OAAOZ,SAAS0B,eAAe,kBAE3Cb,WACF,IAAIC,IAAK,GAAEC,OAAOC,sEAAsEC,gBAAgBT,YACtGU,eAAiBC,MAAMN,YACvBO,mBAAqBF,SAASG,OAEpCV,UAAUa,YAAc,GACxBb,UAAUc,mBAAmB,aAAcL,eAIzCX,YAAcX,MAAMU,SAAUS,YAC1BN,UAAYC,OAAOZ,SAASC,cAAc,kBAE1CY,WACF,IAAIC,IAAK,GAAEC,OAAOC,iEAAiEC,gBAAgBT,YACjGU,eAAiBC,MAAMN,YACvBO,mBAAqBF,SAASG,OAEpCV,UAAUgB,UAAYP"}